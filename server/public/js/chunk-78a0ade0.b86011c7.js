(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-78a0ade0"],{af81:function(e,t,s){"use strict";s.r(t);var a=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("custom-card",{attrs:{title:"Realizar venta",icon:"mdi-plus"},scopedSlots:e._u([{key:"content",fn:function(){return[s("v-container",[s("v-alert",{directives:[{name:"show",rawName:"v-show",value:e.historyMode,expression:"historyMode"}],attrs:{prominent:"",type:"error"}},[s("v-col",{staticClass:"grow"},[e._v("Aviso: Estás en el modo de ventas históricas, por lo que las ventas que registres no modificarán tu stock actual.")])],1),s("v-row",{attrs:{align:"center",dense:""}},[s("p",{staticClass:"body-1 font-weight-bold d-inline mx-3"},[e._v("Fecha:")]),s("v-col",{attrs:{cols:"12",sm:"12",md:"3"}},[s("v-text-field",{staticClass:"date-width",attrs:{outlined:"",dense:"","prepend-icon":"event",type:"date"},model:{value:e.date,callback:function(t){e.date=t},expression:"date"}})],1),s("v-col",{staticClass:"d-flex",attrs:{cols:"12",sm:"4"}},[s("v-select",{attrs:{items:e.commerce,label:"Selecciona el negocio",outlined:"",dense:""},model:{value:e.selectedCommerce,callback:function(t){e.selectedCommerce=t},expression:"selectedCommerce"}})],1),s("v-spacer"),s("v-switch",{staticClass:"mb-5",attrs:{label:"Modo histórico: "+(e.historyMode?"Activo":"Inactivo")},model:{value:e.historyMode,callback:function(t){e.historyMode=t},expression:"historyMode"}})],1),s("v-btn",{staticClass:"my-3",attrs:{tile:"",color:"primary"}},[s("v-icon",{attrs:{left:""}},[e._v("search")]),e._v("Búsqueda ")],1),"SOFTWARE"==e.selectedCommerce||"HARDWARE"==e.selectedCommerce?s("v-autocomplete",{staticClass:"search-field mr-3",attrs:{placeholder:"Escribe el nombre del servicio",items:e.services,"item-text":"name","item-value":"_id","return-object":!0,dense:"",outlined:""},on:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.addSale(e.selectedProduct)},change:function(t){return e.addSale(e.selectedProduct)}},model:{value:e.selectedProduct,callback:function(t){e.selectedProduct=t},expression:"selectedProduct"}}):s("v-autocomplete",{staticClass:"search-field mr-3",attrs:{placeholder:"Escribe el nombre del producto",items:e.products,"item-text":"name","item-value":"_id","return-object":!0,dense:"",outlined:""},on:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.addSale(e.selectedProduct)},change:function(t){return e.addSale(e.selectedProduct)}},model:{value:e.selectedProduct,callback:function(t){e.selectedProduct=t},expression:"selectedProduct"}}),s("v-btn",{attrs:{outlined:"",color:"primary",to:{name:"salesHistory"}}},[s("v-icon",{attrs:{left:""}},[e._v("mdi-format-list-checks")]),e._v("Ver historial ")],1),"SOFTWARE"==e.selectedCommerce||"HARDWARE"==e.selectedCommerce?s("v-simple-table",{scopedSlots:e._u([{key:"default",fn:function(){return[s("thead",[s("tr",[s("th",{staticClass:"text-left"},[s("span",[e._v("Tipo")])]),s("th",{staticClass:"text-left"},[s("span",[e._v("Servicio")])]),s("th",{staticClass:"text-left"},[s("span",[e._v("Costo")])]),s("th",{staticClass:"text-left"},[s("span",[e._v("Precio de servicio")])]),s("th",{staticClass:"text-left"},[s("span",[e._v("Datos del celular")])]),s("th",{staticClass:"text-left"},[s("span",[e._v("Descripción")])]),s("th",{staticClass:"text-left"},[s("span",[e._v("Eliminar servicio")])])])]),s("tbody",e._l(e.sales,(function(t,a){return s("tr",{key:"a"+a},[s("td",[e._v(e._s(t.productDetails.typeId?t.productDetails.typeId.name:"Sin tipo"))]),s("td",[e._v(e._s(t.productDetails.name))]),s("td",[s("v-text-field",{staticClass:"inputs-width",attrs:{prefix:"S/.",type:"number"},model:{value:t.purchasePrice,callback:function(s){e.$set(t,"purchasePrice",s)},expression:"product.purchasePrice"}})],1),s("td",[s("v-text-field",{staticClass:"inputs-width",attrs:{prefix:"S/.",type:"number"},model:{value:t.purchasePrice,callback:function(s){e.$set(t,"purchasePrice",s)},expression:"product.purchasePrice"}})],1),s("td",[s("ul",[s("li",[e._v(" Modelo: "),s("v-text-field",{staticClass:"inputs-width",attrs:{type:"text"},model:{value:t.purchasePrice,callback:function(s){e.$set(t,"purchasePrice",s)},expression:"product.purchasePrice"}})],1),s("li",[e._v(" Marca: "),s("v-text-field",{staticClass:"inputs-width",attrs:{type:"text"},model:{value:t.purchasePrice,callback:function(s){e.$set(t,"purchasePrice",s)},expression:"product.purchasePrice"}})],1)])]),s("td",[s("v-textarea",{attrs:{outlined:"",placeholder:"Descripción"}})],1),s("td",[s("v-btn",{attrs:{small:"",color:"error"},on:{click:function(t){return e.deleteSale(a)}}},[e._v("Eliminar")])],1)])})),0)]},proxy:!0}],null,!1,1679236240)}):s("v-simple-table",{scopedSlots:e._u([{key:"default",fn:function(){return[s("thead",[s("tr",[s("th",{staticClass:"text-left"},[s("span",[e._v("Tipo")])]),s("th",{staticClass:"text-left"},[s("span",[e._v("Producto")])]),s("th",{staticClass:"text-left"},[s("span",[e._v("Cantidad")])]),s("th",{staticClass:"text-left"},[s("span",[e._v("Precio de compra")])]),s("th",{staticClass:"text-left"},[s("span",[e._v("Precio de venta")])]),s("th",{staticClass:"text-left"},[s("span",[e._v("Subtotal")])]),s("th",{staticClass:"text-left"},[s("span",[e._v("Eliminar producto")])])])]),s("tbody",e._l(e.sales,(function(t,a){return s("tr",{key:"a"+a},[s("td",[e._v(e._s(t.productDetails.typeId?t.productDetails.typeId.name:"Sin tipo"))]),s("td",[e._v(e._s(t.productDetails.name))]),s("td",[s("v-text-field",{staticClass:"inputs-width",attrs:{suffix:"unidades",type:"number"},model:{value:t.qty,callback:function(s){e.$set(t,"qty",s)},expression:"product.qty"}})],1),s("td",[e.editPurchasePrice?s("v-text-field",{staticClass:"inputs-width",attrs:{prefix:"S/.",type:"number"},model:{value:t.purchasePrice,callback:function(s){e.$set(t,"purchasePrice",s)},expression:"product.purchasePrice"}}):s("v-btn",{attrs:{color:"error",outlined:"",small:""},on:{click:function(t){e.editPurchasePrice=!0}}},[e._v("Editar")])],1),s("td",[s("v-text-field",{staticClass:"inputs-width",attrs:{prefix:"S/.",type:"number"},model:{value:t.salePrice,callback:function(s){e.$set(t,"salePrice",s)},expression:"product.salePrice"}})],1),s("td",[e._v("S/."+e._s(t.salePrice*t.qty))]),s("td",[s("v-btn",{attrs:{small:"",color:"error"},on:{click:function(t){return e.deleteSale(a)}}},[e._v("Eliminar")])],1)])})),0)]},proxy:!0}])}),"SOFTWARE"==e.selectedCommerce||"HARDWARE"==e.selectedCommerce?s("v-alert",{directives:[{name:"show",rawName:"v-show",value:0==e.sales.length,expression:"sales.length==0"}],staticClass:"my-5",attrs:{type:"warning",text:""}},[e._v("Aún no agregaste servicios a esta venta")]):s("v-alert",{directives:[{name:"show",rawName:"v-show",value:0==e.sales.length,expression:"sales.length==0"}],staticClass:"my-5",attrs:{type:"warning",text:""}},[e._v("Aún no agregaste productos a esta venta")]),s("v-row",{staticClass:"mr-3 mb-3",attrs:{justify:"end"}},[s("v-card",{staticClass:"pa-3",attrs:{dark:"",outlined:"",color:"info"}},[s("strong",{staticClass:"text--white"},[e._v("Total:")]),e._v(" "),s("span",{staticClass:"total"},[e._v("S/."+e._s(e.getTotal))])])],1),s("v-btn",{attrs:{loading:e.loadingButton,color:"success"},on:{click:function(t){return e.saveSale(e.sales,e.date,e.selectedCommerce)}}},[e._v("Terminar venta")])],1)]},proxy:!0}])})},r=[],c=(s("13d5"),s("a434"),s("b85c")),i=(s("96cf"),s("1da1")),l={data:function(){return{commerce:["VENTA DE ACCESORIOS","VENTA DE REPUESTOS","SOFTWARE","HARDWARE","CELULARES"],selectedCommerce:"",editPurchasePrice:!1,historyMode:!1,selectedProduct:null,date:(new Date).toISOString().substr(0,10),menu:!1,sales:[],total:0,productsLoading:!1,servicesLoading:!1,loadingButton:!1}},methods:{deleteSale:function(e){this.sales.splice(e,1)},addSale:function(e){e&&this.sales.push({productDetails:e,productId:e._id,qty:1,purchasePrice:e.purchasePrice,salePrice:e.price,history:this.historyMode})},saveSale:function(e,t,s){var a=this;return Object(i["a"])(regeneratorRuntime.mark((function r(){var i,l,o,n,d,u,p,v,m,f,h,y;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:a.loadingButton=!0,e=a.$deepCopy(e),i=Object(c["a"])(e);try{for(i.s();!(l=i.n()).done;)o=l.value,delete o["productDetails"]}catch(x){i.e(x)}finally{i.f()}if(a.historyMode){n=Object(c["a"])(e);try{for(n.s();!(d=n.n()).done;)u=d.value,u.history=!0}catch(x){n.e(x)}finally{n.f()}}else{p=Object(c["a"])(e);try{for(p.s();!(v=p.n()).done;)m=v.value,m.history=!1}catch(x){p.e(x)}finally{p.f()}}return r.prev=5,t=new Date(t),t=new Date(t.getTime()- -6e4*t.getTimezoneOffset()),r.next=10,a.$store.dispatch("salesModule/create",{products:e,date:t,commerce:s});case 10:f=Object(c["a"])(e);try{for(f.s();!(h=f.n()).done;)y=h.value,y.history||a.$store.commit("productsModule/updateStock",{productId:y.productId,qty:-y.qty})}catch(x){f.e(x)}finally{f.f()}a.sales=[];case 13:return r.prev=13,a.loadingButton=!1,r.finish(13);case 16:case"end":return r.stop()}}),r,null,[[5,,13,16]])})))()}},computed:{products:function(){return this.$store.state.productsModule.products},services:function(){return this.$store.state.servicesModule.services},getTotal:function(){return this.sales.reduce((function(e,t){return e+t.salePrice*t.qty}),0)}}},o=l,n=(s("cda3"),s("2877")),d=s("6544"),u=s.n(d),p=s("0798"),v=s("c6a6"),m=s("8336"),f=s("b0af"),h=s("62ad"),y=s("a523"),x=s("132d"),C=s("0fd9"),b=s("b974"),_=s("1f4f"),P=s("2fa4"),S=s("b73d"),k=s("8654"),w=s("a844"),g=Object(n["a"])(o,a,r,!1,null,"0e38c504",null);t["default"]=g.exports;u()(g,{VAlert:p["a"],VAutocomplete:v["a"],VBtn:m["a"],VCard:f["a"],VCol:h["a"],VContainer:y["a"],VIcon:x["a"],VRow:C["a"],VSelect:b["a"],VSimpleTable:_["a"],VSpacer:P["a"],VSwitch:S["a"],VTextField:k["a"],VTextarea:w["a"]})},cda3:function(e,t,s){"use strict";var a=s("dced"),r=s.n(a);r.a},dced:function(e,t,s){}}]);
//# sourceMappingURL=chunk-78a0ade0.b86011c7.js.map