(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-69025d6a"],{"4df7":function(t,e,a){"use strict";var s=a("4ff5"),r=a.n(s);r.a},"4ff5":function(t,e,a){},af81:function(t,e,a){"use strict";a.r(e);var s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("custom-card",{attrs:{title:"Realizar venta",icon:"mdi-plus"},scopedSlots:t._u([{key:"content",fn:function(){return[a("v-container",[a("v-alert",{directives:[{name:"show",rawName:"v-show",value:t.historyMode,expression:"historyMode"}],attrs:{prominent:"",type:"error"}},[a("v-col",{staticClass:"grow"},[t._v("Aviso: Estás en el modo de ventas históricas, por lo que las ventas que registres no modificarán tu stock actual.")])],1),a("v-row",{attrs:{align:"center"}},[a("p",{staticClass:"body-1 font-weight-bold d-inline mx-3"},[t._v("Fecha:")]),a("v-menu",{attrs:{"close-on-content-click":!1,transition:"scale-transition","offset-y":"","max-width":"290px","min-width":"290px"},scopedSlots:t._u([{key:"activator",fn:function(e){var s=e.on,r=e.attrs;return[a("v-text-field",t._g(t._b({staticClass:"date-width",attrs:{"persistent-hint":"","prepend-inner-icon":"event",readonly:"",outlined:"",dense:""},model:{value:t.date,callback:function(e){t.date=e},expression:"date"}},"v-text-field",r,!1),s))]}}]),model:{value:t.menu,callback:function(e){t.menu=e},expression:"menu"}},[a("v-date-picker",{attrs:{"no-title":""},on:{input:function(e){t.menu=!1}},model:{value:t.date,callback:function(e){t.date=e},expression:"date"}})],1),a("v-col",{staticClass:"d-flex",attrs:{cols:"12",sm:"6"}},[a("v-select",{attrs:{items:t.items,label:"Selecciona el negocio",outlined:"",dense:""}})],1),a("v-spacer"),a("v-switch",{attrs:{label:"Modo histórico: "+(t.historyMode?"Activo":"Inactivo")},model:{value:t.historyMode,callback:function(e){t.historyMode=e},expression:"historyMode"}})],1),a("v-btn",{staticClass:"my-3",attrs:{tile:"",color:"primary"}},[a("v-icon",{attrs:{left:""}},[t._v("search")]),t._v("Búsqueda ")],1),a("v-autocomplete",{staticClass:"search-field mr-3",attrs:{placeholder:"Escribe el nombre del producto",loading:t.productsLoading,items:t.products,"item-text":"name","item-value":"_id","return-object":!0,dense:"",outlined:""},on:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.addSale(t.selectedProduct)},click:t.productsList,change:function(e){return t.addSale(t.selectedProduct)}},scopedSlots:t._u([{key:"no-data",fn:function(){return[t.productsLoading?a("v-container",{staticClass:"text-center",attrs:{fluid:""}},[a("v-progress-circular",{attrs:{indeterminate:"",color:"primary"}})],1):t._e()]},proxy:!0}]),model:{value:t.selectedProduct,callback:function(e){t.selectedProduct=e},expression:"selectedProduct"}}),a("v-btn",{attrs:{outlined:"",color:"primary",to:{name:"salesHistory"}}},[a("v-icon",{attrs:{left:""}},[t._v("mdi-format-list-checks")]),t._v("Ver historial ")],1),a("v-simple-table",{scopedSlots:t._u([{key:"default",fn:function(){return[a("thead",[a("tr",[a("th",{staticClass:"text-left"},[a("span",[t._v("Producto")])]),a("th",{staticClass:"text-left"},[a("span",[t._v("Cantidad")])]),a("th",{staticClass:"text-left"},[a("span",[t._v("Precio de compra")])]),a("th",{staticClass:"text-left"},[a("span",[t._v("Precio de venta")])]),a("th",{staticClass:"text-left"},[a("span",[t._v("Descripción")])]),a("th",{staticClass:"text-left"},[a("span",[t._v("Subtotal")])]),a("th",{staticClass:"text-left"},[a("span",[t._v("Eliminar producto")])])])]),a("tbody",t._l(t.sales,(function(e,s){return a("tr",{key:"a"+s},[a("td",[t._v(t._s(e.productDetails.name))]),a("td",[a("v-text-field",{staticClass:"inputs-width",attrs:{suffix:"unidades",type:"number"},model:{value:e.qty,callback:function(a){t.$set(e,"qty",a)},expression:"product.qty"}})],1),a("td",[t.editPurchasePrice?a("v-text-field",{staticClass:"inputs-width",attrs:{prefix:"S/.",type:"number"},model:{value:e.purchasePrice,callback:function(a){t.$set(e,"purchasePrice",a)},expression:"product.purchasePrice"}}):a("v-btn",{attrs:{color:"error",outlined:"",small:""},on:{click:function(e){t.editPurchasePrice=!0}}},[t._v("Editar")])],1),a("td",[a("v-text-field",{staticClass:"inputs-width",attrs:{prefix:"S/.",type:"number"},model:{value:e.salePrice,callback:function(a){t.$set(e,"salePrice",a)},expression:"product.salePrice"}})],1),a("td",[a("v-textarea",{attrs:{name:"input-7-1",label:"Default style",value:"The Woodman set to work at once, and so sharp was his axe that the tree was soon chopped nearly through.",hint:"Hint text"}})],1),a("td",[t._v("S/."+t._s(e.salePrice*e.qty))]),a("td",[a("v-btn",{attrs:{small:"",color:"error"},on:{click:function(e){return t.deleteSale(s)}}},[t._v("Eliminar")])],1)])})),0)]},proxy:!0}])}),a("v-alert",{directives:[{name:"show",rawName:"v-show",value:0==t.sales.length,expression:"sales.length==0"}],staticClass:"my-5",attrs:{type:"warning",text:""}},[t._v("Aún no agregaste productos a esta venta")]),a("v-row",{staticClass:"mr-3 mb-3",attrs:{justify:"end"}},[a("v-card",{staticClass:"pa-3",attrs:{dark:"",outlined:"",color:"info"}},[a("strong",{staticClass:"text--white"},[t._v("Total:")]),t._v(" "),a("span",{staticClass:"total"},[t._v("S/."+t._s(t.getTotal))])])],1),a("v-btn",{attrs:{loading:t.loadingButton,color:"success"},on:{click:function(e){return t.saveSale(t.sales,t.date)}}},[t._v("Terminar venta")])],1)]},proxy:!0}])})},r=[],n=(a("13d5"),a("a434"),a("b85c")),o=(a("96cf"),a("1da1")),i={data:function(){return{items:["VENTA DE ACCESORIOS","VENTA DE REPUESTOS","SOFTWARE","HARDWARE"],editPurchasePrice:!1,historyMode:!1,selectedProduct:null,date:(new Date).toISOString().substr(0,10),menu:!1,sales:[],total:0,productsLoading:!1,loadingButton:!1}},methods:{deleteSale:function(t){this.sales.splice(t,1)},addSale:function(t){t&&this.sales.push({productDetails:t,productId:t._id,qty:1,purchasePrice:t.purchasePrice,salePrice:t.price,history:this.historyMode})},saveSale:function(t,e){var a=this;return Object(o["a"])(regeneratorRuntime.mark((function s(){var r,o,i,c,l,d,u,p,f,v,h,m,y,x,b,w,g,_;return regeneratorRuntime.wrap((function(s){while(1)switch(s.prev=s.next){case 0:a.loadingButton=!0,t=a.$deepCopy(t),r=Object(n["a"])(t);try{for(r.s();!(o=r.n()).done;)i=o.value,delete i["productDetails"]}catch(k){r.e(k)}finally{r.f()}if(a.historyMode){c=Object(n["a"])(t);try{for(c.s();!(l=c.n()).done;)d=l.value,d.history=!0}catch(k){c.e(k)}finally{c.f()}}else{u=Object(n["a"])(t);try{for(u.s();!(p=u.n()).done;)f=p.value,f.history=!1}catch(k){u.e(k)}finally{u.f()}}return v=new Date,h=v.getDate(),m=v.getHours(),y=v.getMinutes(),x=v.getSeconds(),b=new Date(e),b=new Date(b.setDate(h)),b=new Date(b.setHours(m)),b=new Date(b.setMinutes(y)),b=new Date(b.setSeconds(x)),s.prev=15,s.next=18,a.$store.dispatch("salesModule/create",{products:t,date:b});case 18:w=Object(n["a"])(t);try{for(w.s();!(g=w.n()).done;)_=g.value,_.history||a.$store.commit("productsModule/updateStock",{productId:_.productId,qty:-_.qty})}catch(k){w.e(k)}finally{w.f()}a.sales=[];case 21:return s.prev=21,a.loadingButton=!1,s.finish(21);case 24:case"end":return s.stop()}}),s,null,[[15,,21,24]])})))()},productsList:function(){var t=this;return Object(o["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(0!==t.products.length){e.next=8;break}return t.productsLoading=!0,e.prev=2,e.next=5,t.$store.dispatch("productsModule/list");case 5:return e.prev=5,t.productsLoading=!1,e.finish(5);case 8:case"end":return e.stop()}}),e,null,[[2,,5,8]])})))()}},computed:{products:function(){return this.$store.state.productsModule.products},getTotal:function(){return this.sales.reduce((function(t,e){return t+e.salePrice*e.qty}),0)}}},c=i,l=(a("4df7"),a("2877")),d=a("6544"),u=a.n(d),p=a("0798"),f=a("c6a6"),v=a("8336"),h=a("b0af"),m=a("62ad"),y=a("a523"),x=a("2e4b"),b=a("132d"),w=a("e449"),g=a("490a"),_=a("0fd9"),k=a("b974"),C=a("1f4f"),S=a("2fa4"),P=a("b73d"),V=a("8654"),D=a("a844"),M=Object(l["a"])(c,s,r,!1,null,"022c435d",null);e["default"]=M.exports;u()(M,{VAlert:p["a"],VAutocomplete:f["a"],VBtn:v["a"],VCard:h["a"],VCol:m["a"],VContainer:y["a"],VDatePicker:x["a"],VIcon:b["a"],VMenu:w["a"],VProgressCircular:g["a"],VRow:_["a"],VSelect:k["a"],VSimpleTable:C["a"],VSpacer:S["a"],VSwitch:P["a"],VTextField:V["a"],VTextarea:D["a"]})}}]);
//# sourceMappingURL=chunk-69025d6a.954e1959.js.map