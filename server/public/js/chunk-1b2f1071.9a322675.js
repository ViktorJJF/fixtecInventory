(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-1b2f1071"],{"53f5":function(t,e,a){},"737d":function(t,e,a){"use strict";a.d(e,"a",(function(){return c}));var r=a("fd3a"),o=a("49ef"),s=a("fbb4");function c(t,e){if(arguments.length<1)throw new TypeError("1 argument required, but only ".concat(arguments.length," present"));var a=Object(r["a"])(t);if(!Object(o["a"])(a))throw new RangeError("Invalid time value");var c=e||{},n=null==c.format?"extended":String(c.format),i=null==c.representation?"complete":String(c.representation);if("extended"!==n&&"basic"!==n)throw new RangeError("format must be 'extended' or 'basic'");if("date"!==i&&"time"!==i&&"complete"!==i)throw new RangeError("representation must be 'date', 'time', or 'complete'");var l="",d="",u="extended"===n?"-":"",p="extended"===n?":":"";if("time"!==i){var f=Object(s["a"])(a.getDate(),2),v=Object(s["a"])(a.getMonth()+1,2),h=Object(s["a"])(a.getFullYear(),4);l="".concat(h).concat(u).concat(v).concat(u).concat(f)}if("date"!==i){var m=a.getTimezoneOffset();if(0!==m){var b=Math.abs(m),g=Object(s["a"])(Math.floor(b/60),2),y=Object(s["a"])(b%60,2),w=m<0?"+":"-";d="".concat(w).concat(g,":").concat(y)}else d="Z";var x=Object(s["a"])(a.getHours(),2),_=Object(s["a"])(a.getMinutes(),2),C=Object(s["a"])(a.getSeconds(),2),O=""===l?"":"T",k=[x,_,C].join(p);l="".concat(l).concat(O).concat(k).concat(d)}return l}},ea35:function(t,e,a){"use strict";var r=a("53f5"),o=a.n(r);o.a},f32d:function(t,e,a){"use strict";a.r(e);var r=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("custom-card",{attrs:{title:"Realizar compra",icon:"mdi-plus"},scopedSlots:t._u([{key:"content",fn:function(){return[a("v-container",[a("v-alert",{directives:[{name:"show",rawName:"v-show",value:t.historyMode,expression:"historyMode"}],attrs:{prominent:"",type:"error"}},[a("v-col",{staticClass:"grow"},[t._v("Aviso: Estás en el modo de compras históricas, por lo que las compras que registres no modificarán tu stock actual.")])],1),a("v-row",{attrs:{align:"center",dense:""}},[a("p",{staticClass:"body-1 font-weight-bold d-inline mx-3"},[t._v("Fecha:")]),a("v-col",{attrs:{cols:"12",sm:"12",md:"3"}},[a("v-text-field",{staticClass:"date-width",attrs:{outlined:"",dense:"","prepend-icon":"event",type:"date"},model:{value:t.date,callback:function(e){t.date=e},expression:"date"}})],1),a("v-col",{staticClass:"d-flex",attrs:{cols:"12",sm:"4"}},[a("v-select",{attrs:{items:t.commerce,label:"Selecciona el negocio",outlined:"",dense:""},model:{value:t.selectedCommerce,callback:function(e){t.selectedCommerce=e},expression:"selectedCommerce"}})],1),a("v-spacer")],1),a("v-dialog",{attrs:{width:"1200"},scopedSlots:t._u([{key:"activator",fn:function(e){var r=e.on;return[a("v-tooltip",{attrs:{bottom:""},scopedSlots:t._u([{key:"activator",fn:function(e){var o=e.on;return[a("v-btn",t._g({staticClass:"my-3 mr-3",attrs:{tile:"",color:"primary"}},Object.assign({},o,r)),[a("v-icon",{attrs:{left:""}},[t._v("search")]),t._v("Agregar producto ")],1)]}}],null,!0)},[a("span",[t._v("Inventario")])])]}}]),model:{value:t.dialog,callback:function(e){t.dialog=e},expression:"dialog"}},[a("v-card",[a("v-toolbar",{attrs:{color:"primary",dark:""}},[a("v-toolbar-title",[t._v("Productos")])],1),a("v-container",[a("products",{attrs:{selectButton:!0},on:{"add-product":t.addPurchase}})],1),a("v-divider"),a("v-card-actions",[a("v-spacer"),a("v-btn",{attrs:{color:"primary",text:""},on:{click:function(e){t.dialog=!1}}},[t._v("De acuerdo")])],1)],1)],1),a("v-btn",{attrs:{outlined:"",color:"primary",to:{name:"historyPurchase"}}},[a("v-icon",{attrs:{left:""}},[t._v("mdi-format-list-checks")]),t._v("Ver historial ")],1),a("v-simple-table",{scopedSlots:t._u([{key:"default",fn:function(){return[a("thead",[a("tr",[a("th",{staticClass:"text-left"},[a("span",[t._v("Tipo")])]),a("th",{staticClass:"text-left"},[a("span",[t._v("Producto")])]),a("th",{staticClass:"text-left"},[a("span",[t._v("Marca")])]),a("th",{staticClass:"text-left"},[a("span",[t._v("Cantidad")])]),a("th",{staticClass:"text-left"},[a("span",[t._v("Precio de compra")])]),a("th",{staticClass:"text-left"},[a("span",[t._v("Subtotal")])]),a("th",{staticClass:"text-left"},[a("span",[t._v("Eliminar producto")])])])]),a("tbody",t._l(t.purchases,(function(e,r){return a("tr",{key:"a"+r},[a("td",[t._v(t._s(e.productDetails.typeId?e.productDetails.typeId.name:"Sin tipo"))]),a("td",[t._v(t._s(e.productDetails.name))]),a("td",[t._v(t._s(e.productDetails.brandId?e.productDetails.brandId.name:"Sin Marca"))]),a("td",[a("v-text-field",{staticClass:"inputs-width",attrs:{suffix:"unidades",type:"number"},model:{value:e.qty,callback:function(a){t.$set(e,"qty",a)},expression:"product.qty"}})],1),a("td",[a("v-text-field",{staticClass:"inputs-width",attrs:{prefix:"S/.",type:"number"},model:{value:e.purchasePrice,callback:function(a){t.$set(e,"purchasePrice",a)},expression:"product.purchasePrice"}})],1),a("td",[t._v("S/."+t._s((e.purchasePrice*e.qty).toFixed(2)))]),a("td",[a("v-btn",{attrs:{small:"",color:"error"},on:{click:function(e){return t.deletePurchase(r)}}},[t._v("Eliminar")])],1)])})),0)]},proxy:!0}])}),a("v-alert",{directives:[{name:"show",rawName:"v-show",value:0==t.purchases.length,expression:"purchases.length==0"}],staticClass:"my-5",attrs:{type:"warning",text:""}},[t._v("Aún no agregaste productos a esta compra")]),a("v-row",{staticClass:"mr-3 mb-3",attrs:{justify:"end"}},[a("v-card",{staticClass:"pa-3",attrs:{dark:"",outlined:"",color:"info"}},[a("strong",{staticClass:"text--white"},[t._v("Total:")]),t._v(" "),a("span",{staticClass:"total"},[t._v("S/."+t._s(t.getTotal))])])],1),a("v-btn",{attrs:{loading:t.loadingButton,color:"success"},on:{click:function(e){return t.savePurchase(t.purchases,t.date,t.selectedCommerce)}}},[t._v("Terminar compra")])],1)]},proxy:!0}])})},o=[],s=(a("13d5"),a("a434"),a("b680"),a("b85c")),c=(a("96cf"),a("1da1")),n=a("d101"),i=a("737d"),l={components:{products:n["a"]},data:function(){return{dialog:null,commerce:["VENTA DE ACCESORIOS","VENTA DE REPUESTOS","SOFTWARE","HARDWARE","CELULARES"],selectedCommerce:"",historyMode:!1,selectedProduct:null,date:Object(i["a"])(new Date,{representation:"date"}),menu:!1,purchases:[],total:0,productsLoading:!1,loadingButton:!1}},methods:{deletePurchase:function(t){this.purchases.splice(t,1)},addPurchase:function(t){t&&(this.purchases.push({productDetails:t,productId:t._id,qty:1,purchasePrice:t.purchasePrice,history:this.historyMode}),this.dialog=!1)},savePurchase:function(t,e,a){var r=this;return Object(c["a"])(regeneratorRuntime.mark((function o(){var c,n,i,l,d,u,p,f,v,h,m,b;return regeneratorRuntime.wrap((function(o){while(1)switch(o.prev=o.next){case 0:r.loadingButton=!0,t=r.$deepCopy(t),c=Object(s["a"])(t);try{for(c.s();!(n=c.n()).done;)i=n.value,delete i["productDetails"]}catch(g){c.e(g)}finally{c.f()}if(r.historyMode){l=Object(s["a"])(t);try{for(l.s();!(d=l.n()).done;)u=d.value,u.history=!0}catch(g){l.e(g)}finally{l.f()}}else{p=Object(s["a"])(t);try{for(p.s();!(f=p.n()).done;)v=f.value,v.history=!1}catch(g){p.e(g)}finally{p.f()}}return o.prev=5,e=new Date(e),e=new Date(e.getTime()- -6e4*e.getTimezoneOffset()),o.next=10,r.$store.dispatch("purchasesModule/create",{history:r.historyMode,products:t,date:e,commerce:a});case 10:h=Object(s["a"])(t);try{for(h.s();!(m=h.n()).done;)b=m.value,b.history||r.$store.commit("productsModule/updateStock",{productId:b.productId,qty:+b.qty})}catch(g){h.e(g)}finally{h.f()}r.purchases=[];case 13:return o.prev=13,r.loadingButton=!1,o.finish(13);case 16:case"end":return o.stop()}}),o,null,[[5,,13,16]])})))()},productsList:function(){var t=this;return Object(c["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(0!==t.products.length){e.next=8;break}return t.productsLoading=!0,e.prev=2,e.next=5,t.$store.dispatch("productsModule/list");case 5:return e.prev=5,t.productsLoading=!1,e.finish(5);case 8:case"end":return e.stop()}}),e,null,[[2,,5,8]])})))()}},computed:{products:function(){return this.$store.state.productsModule.products},getTotal:function(){return this.purchases.reduce((function(t,e){return t+e.purchasePrice*e.qty}),0).toFixed(2)}}},d=l,u=(a("ea35"),a("2877")),p=a("6544"),f=a.n(p),v=a("0798"),h=a("8336"),m=a("b0af"),b=a("99d9"),g=a("62ad"),y=a("a523"),w=a("169a"),x=a("ce7e"),_=a("132d"),C=a("0fd9"),O=a("b974"),k=a("1f4f"),S=a("2fa4"),j=a("8654"),T=a("71d9"),V=a("2a7f"),E=a("3a2f"),P=Object(u["a"])(d,r,o,!1,null,"b09bddae",null);e["default"]=P.exports;f()(P,{VAlert:v["a"],VBtn:h["a"],VCard:m["a"],VCardActions:b["b"],VCol:g["a"],VContainer:y["a"],VDialog:w["a"],VDivider:x["a"],VIcon:_["a"],VRow:C["a"],VSelect:O["a"],VSimpleTable:k["a"],VSpacer:S["a"],VTextField:j["a"],VToolbar:T["a"],VToolbarTitle:V["c"],VTooltip:E["a"]})}}]);
//# sourceMappingURL=chunk-1b2f1071.9a322675.js.map