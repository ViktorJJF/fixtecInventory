(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-dabc0fd0"],{"1d0d":function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("custom-card",{attrs:{title:"Historial de ventas de servicios",icon:"mdi-format-list-checks"},scopedSlots:e._u([{key:"content",fn:function(){return[a("v-row",{staticClass:"mb-3",attrs:{align:"center"}},[a("v-col",{attrs:{cols:"12",sm:"4"}},[a("span",{staticClass:"body-1 font-weight-bold d-inline mx-3"},[e._v("Desde:")]),a("v-text-field",{staticClass:"mr-3 mb-3",attrs:{outlined:"",dense:"","prepend-icon":"event",type:"date","hide-details":"",clearable:""},model:{value:e.filters.startDate,callback:function(t){e.$set(e.filters,"startDate",t)},expression:"filters.startDate"}})],1),a("v-col",{attrs:{cols:"12",sm:"4"}},[a("span",{staticClass:"body-1 font-weight-bold d-inline mx-3"},[e._v("Hasta:")]),a("v-text-field",{staticClass:"mr-3 mb-3",attrs:{outlined:"",dense:"","prepend-icon":"event",type:"date","hide-details":"",clearable:""},model:{value:e.filters.endDate,callback:function(t){e.$set(e.filters,"endDate",t)},expression:"filters.endDate"}})],1),a("v-col",{attrs:{cols:"12",sm:"4"}},[a("span",{staticClass:"body-1 font-weight-bold d-inline mx-3"},[e._v("Negocio:")]),a("v-select",{staticClass:"mr-3 mb-3",attrs:{clearable:"","hide-details":"",dense:"",placeholder:"Selecciona un negocio",items:["SOFTWARE","HARDWARE"],outlined:""},on:{"click:clear":function(t){e.filters.commerce=null}},model:{value:e.filters.commerce,callback:function(t){e.$set(e.filters,"commerce",t)},expression:"filters.commerce"}})],1),a("v-col",{attrs:{cols:"12",sm:"6"}},[a("v-row",{directives:[{name:"show",rawName:"v-show",value:e.filters.product,expression:"filters.product"}]},[e.filters.product?a("v-simple-table",{scopedSlots:e._u([{key:"default",fn:function(){return[a("thead",[a("tr",[a("th",{staticClass:"text-left"},[a("span",[e._v("Tipo")])]),a("th",{staticClass:"text-left"},[a("span",[e._v("Nombre")])]),a("th",{staticClass:"text-left"},[a("span",[e._v("Marca")])])])]),a("tbody",[a("tr",[a("td",[e._v(e._s(e.productById(e.filters.product).typeId?e.productById(e.filters.product).typeId.name:"Sin tipo"))]),a("td",[e._v(e._s(e.productById(e.filters.product).name))]),a("td",[e._v(e._s(e.productById(e.filters.product).brandId?e.productById(e.filters.product).brandId.name:"Sin marca"))]),a("td",[a("v-btn",{attrs:{color:"error",small:""},on:{click:function(t){e.filters.product=null}}},[e._v("Limpiar")])],1)])])]},proxy:!0}],null,!1,1458898029)}):e._e()],1)],1)],1),a("v-row",{attrs:{justify:"center"}},[a("v-col",{attrs:{cols:"12",sm:"6"}},[a("v-btn",{attrs:{block:"",color:"success"},on:{click:function(t){return e.initialData(1,e.filters)}}},[e._v("Buscar!")])],1)],1),a("v-col",{attrs:{cols:"12",sm:"12"}},[a("p",[a("strong",[e._v("Cantidad de ventas de servicios:")]),e._v(" "+e._s(e.$store.state.salesServicesModule.total)+" ")])]),a("div",{staticClass:"text-center pt-2"},[a("v-pagination",{attrs:{length:e.totalPages},on:{input:function(t){return e.initialData(e.page,e.filters)}},model:{value:e.page,callback:function(t){e.page=t},expression:"page"}})],1),a("v-data-table",{staticClass:"elevation-1",attrs:{loading:!e.isDataReady,headers:e.headers,items:e.salesServices,options:e.pagination,"items-per-page":500,"hide-default-footer":"","server-items-length":e.totalItems},on:{"update:options":function(t){e.pagination=t}},scopedSlots:e._u([{key:"no-data",fn:function(){return[a("v-alert",{attrs:{type:"error",value:!0}},[e._v("Aún no cuentas con un historial de ventas")])]},proxy:!0},{key:"item.services",fn:function(t){var r=t.item;return[a("ul",e._l(r.services,(function(t){return a("li",{key:t._id},[e._v(" "+e._s(t.serviceId.name)+" (Costo: "),a("span",{staticClass:"perdida"},[e._v(e._s(t.cost.value))]),e._v(") ")])})),0)]}},{key:"item.amount",fn:function(t){var r=t.item;return[a("span",{staticClass:"ganancia"},[e._v("S/."+e._s(e.totalRevenue(r.services)))])]}},{key:"item.commerce",fn:function(t){var r=t.item;return[a("span",[e._v(e._s(r.commerce))])]}},{key:"item.date",fn:function(t){var r=t.item;return[a("div",[a("v-text-field",{directives:[{name:"show",rawName:"v-show",value:e.editMode&&r._id==e.editedIndex,expression:"editMode && item._id==editedIndex"}],staticClass:"mt-4",attrs:{outlined:"",dense:"","prepend-icon":"event",type:"date"},model:{value:e.editedDate,callback:function(t){e.editedDate=t},expression:"editedDate"}}),a("span",{directives:[{name:"show",rawName:"v-show",value:!e.editMode||r._id!=e.editedIndex,expression:"!editMode || item._id!=editedIndex"}]},[e._v(e._s(e._f("formatDate")(r.date)))])],1)]}},{key:"item.actions",fn:function(t){var r=t.item;return[a("v-btn",{directives:[{name:"show",rawName:"v-show",value:!e.editMode||r._id!=e.editedIndex,expression:"!editMode || item._id!=editedIndex"}],staticClass:"mr-2 my-2",attrs:{small:"",color:"info"},on:{click:function(t){e.editMode=!0,e.editedIndex=r._id,e.editedDate=new Date(r.date).toISOString().substr(0,10)}}},[e._v("Editar")]),a("v-btn",{directives:[{name:"show",rawName:"v-show",value:e.editMode&&r._id==e.editedIndex,expression:"editMode && item._id==editedIndex"}],staticClass:"mr-2 my-2",attrs:{small:"",color:"success"},on:{click:function(t){e.saveSaleService(r),e.editMode=!1}}},[e._v("Guardar")]),a("v-btn",{staticClass:"mb-2 my-2",attrs:{small:"",color:"error"},on:{click:function(t){return e.deleteItem(r)}}},[e._v("Eliminar")])]}},{key:"item.createdAt",fn:function(t){var a=t.item;return[e._v(e._s(e._f("formatDate")(a.createdAt)))]}}])}),a("div",{staticClass:"text-center pt-2"},[a("v-pagination",{attrs:{length:e.totalPages},on:{input:function(t){return e.initialData(e.page,e.filters)}},model:{value:e.page,callback:function(t){e.page=t},expression:"page"}})],1)]},proxy:!0}])})},n=[],i=(a("c975"),a("13d5"),a("a434"),a("b680"),a("b85c")),s=(a("96cf"),a("1da1")),o=a("5530"),c=a("b166"),l=a("2f62"),d=a("fa7d"),u={filters:{formatDate:function(e){return Object(c["a"])(new Date(e),"dd/MM/yyyy")}},data:function(){return{filters:{startDate:null,endDate:null,commerce:null},editedDate:null,editedIndex:null,editMode:!1,page:1,pageCount:0,itemsPerPage:10,isDataReady:!1,selectedOrder:0,pagination:{},search:"",dialog:!1,headers:[{text:"Negocio",value:"commerce"},{text:"Fecha de venta",value:"date"},{text:"Servicios",value:"services"},{text:"Ingreso",value:"amount"},{text:"Acciones",value:"actions"}],salesServices:[],orderDetails:[]}},computed:Object(o["a"])(Object(o["a"])({totalItems:function(){return this.$store.state.salesServicesModule.totalSalesServices},totalPages:function(){return this.$store.state.salesServicesModule.totalPages}},Object(l["b"])({productById:"productsModule/productById"})),{},{commerce:function(){return this.$store.state.commerce}}),created:function(){this.initialData()},methods:{initialData:function(e,t){var a=this;return Object(s["a"])(regeneratorRuntime.mark((function r(){return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return r.prev=0,a.$store.dispatch("loadingModule/showLoading"),e=e||1,r.t0=a,r.next=6,a.$store.dispatch("salesServicesModule/list",Object(o["a"])(Object(o["a"])({},t),Object(d["a"])({page:e,itemsPerPage:a.$store.state.itemsPerPage})));case 6:r.t1=r.sent,a.salesServices=r.t0.$deepCopy.call(r.t0,r.t1),r.next=13;break;case 10:r.prev=10,r.t2=r["catch"](0),console.log("algo salio mal...:",r.t2);case 13:return r.prev=13,a.$store.dispatch("loadingModule/showLoading",!1),r.finish(13);case 16:a.isDataReady=!0;case 17:case"end":return r.stop()}}),r,null,[[0,10,13,16]])})))()},saveSaleService:function(e){var t=this;return Object(s["a"])(regeneratorRuntime.mark((function a(){var r;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return r=new Date(t.editedDate),r=new Date(r.getTime()- -6e4*r.getTimezoneOffset()),e.date=r,a.next=5,t.$store.dispatch("salesServicesModule/update",{id:e._id,data:{commerce:e.commerce,date:r}});case 5:case"end":return a.stop()}}),a)})))()},totalRevenue:function(e){return e?e.reduce((function(e,t){return e+t.salePrice}),0).toFixed(2):"S/.0"},deleteItem:function(e){var t=this;return Object(s["a"])(regeneratorRuntime.mark((function a(){var r,n,s,o,c,l,d,u,f;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return r=t.salesServices.indexOf(e),n=t.salesServices[r]._id,s=t.salesServices[r].services,a.next=5,t.$confirm("¿Seguro que deseas eliminar esta venta de servicio? Se sumará el stock a los productos del costo del servicio");case 5:if(!a.sent){a.next=21;break}return a.prev=6,t.$store.dispatch("loadingModule/showLoading"),a.next=10,t.$store.dispatch("salesServicesModule/delete",n);case 10:o=Object(i["a"])(s);try{for(o.s();!(c=o.n()).done;)if(l=c.value,!l.history&&l.cost.products.length>0){d=Object(i["a"])(l.cost.products);try{for(d.s();!(u=d.n()).done;)f=u.value,t.$store.commit("productsModule/updateStock",{productId:f._id,qty:1})}catch(v){d.e(v)}finally{d.f()}}}catch(v){o.e(v)}finally{o.f()}t.salesServices.splice(r,1),a.next=18;break;case 15:a.prev=15,a.t0=a["catch"](6),console.log(a.t0);case 18:return a.prev=18,t.$store.dispatch("loadingModule/showLoading",!1),a.finish(18);case 21:case"end":return a.stop()}}),a,null,[[6,15,18,21]])})))()}}},f=u,v=a("2877"),p=a("6544"),m=a.n(p),h=a("0798"),b=a("8336"),g=a("62ad"),y=a("8fea"),x=a("891e"),S=a("0fd9"),_=a("b974"),w=a("1f4f"),k=a("8654"),D=Object(v["a"])(f,r,n,!1,null,"5babf5ee",null);t["default"]=D.exports;m()(D,{VAlert:h["a"],VBtn:b["a"],VCol:g["a"],VDataTable:y["a"],VPagination:x["a"],VRow:S["a"],VSelect:_["a"],VSimpleTable:w["a"],VTextField:k["a"]})},"3ca3":function(e,t,a){"use strict";var r=a("6547").charAt,n=a("69f3"),i=a("7dd0"),s="String Iterator",o=n.set,c=n.getterFor(s);i(String,"String",(function(e){o(this,{type:s,string:String(e),index:0})}),(function(){var e,t=c(this),a=t.string,n=t.index;return n>=a.length?{value:void 0,done:!0}:(e=r(a,n),t.index+=e.length,{value:e,done:!1})}))},"4df4":function(e,t,a){"use strict";var r=a("0366"),n=a("7b0b"),i=a("9bdd"),s=a("e95a"),o=a("50c4"),c=a("8418"),l=a("35a1");e.exports=function(e){var t,a,d,u,f,v,p=n(e),m="function"==typeof this?this:Array,h=arguments.length,b=h>1?arguments[1]:void 0,g=void 0!==b,y=l(p),x=0;if(g&&(b=r(b,h>2?arguments[2]:void 0,2)),void 0==y||m==Array&&s(y))for(t=o(p.length),a=new m(t);t>x;x++)v=g?b(p[x],x):p[x],c(a,x,v);else for(u=y.call(p),f=u.next,a=new m;!(d=f.call(u)).done;x++)v=g?i(u,b,[d.value,x],!0):d.value,c(a,x,v);return a.length=x,a}},a630:function(e,t,a){var r=a("23e7"),n=a("4df4"),i=a("1c7e"),s=!i((function(e){Array.from(e)}));r({target:"Array",stat:!0,forced:s},{from:n})},b85c:function(e,t,a){"use strict";a.d(t,"a",(function(){return i}));a("a4d3"),a("e01a"),a("d28b"),a("d3b7"),a("3ca3"),a("ddb0"),a("a630"),a("fb6a"),a("b0c0"),a("25f0");function r(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,r=new Array(t);a<t;a++)r[a]=e[a];return r}function n(e,t){if(e){if("string"===typeof e)return r(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);return"Object"===a&&e.constructor&&(a=e.constructor.name),"Map"===a||"Set"===a?Array.from(e):"Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a)?r(e,t):void 0}}function i(e,t){var a;if("undefined"===typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(a=n(e))||t&&e&&"number"===typeof e.length){a&&(e=a);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var s,o=!0,c=!1;return{s:function(){a=e[Symbol.iterator]()},n:function(){var e=a.next();return o=e.done,e},e:function(e){c=!0,s=e},f:function(){try{o||null==a["return"]||a["return"]()}finally{if(c)throw s}}}}},d28b:function(e,t,a){var r=a("746f");r("iterator")},e01a:function(e,t,a){"use strict";var r=a("23e7"),n=a("83ab"),i=a("da84"),s=a("5135"),o=a("861d"),c=a("9bf2").f,l=a("e893"),d=i.Symbol;if(n&&"function"==typeof d&&(!("description"in d.prototype)||void 0!==d().description)){var u={},f=function(){var e=arguments.length<1||void 0===arguments[0]?void 0:String(arguments[0]),t=this instanceof f?new d(e):void 0===e?d():d(e);return""===e&&(u[t]=!0),t};l(f,d);var v=f.prototype=d.prototype;v.constructor=f;var p=v.toString,m="Symbol(test)"==String(d("test")),h=/^Symbol\((.*)\)[^)]+$/;c(v,"description",{configurable:!0,get:function(){var e=o(this)?this.valueOf():this,t=p.call(e);if(s(u,e))return"";var a=m?t.slice(7,-1):t.replace(h,"$1");return""===a?void 0:a}}),r({global:!0,forced:!0},{Symbol:f})}},fb6a:function(e,t,a){"use strict";var r=a("23e7"),n=a("861d"),i=a("e8b5"),s=a("23cb"),o=a("50c4"),c=a("fc6a"),l=a("8418"),d=a("b622"),u=a("1dde"),f=a("ae40"),v=u("slice"),p=f("slice",{ACCESSORS:!0,0:0,1:2}),m=d("species"),h=[].slice,b=Math.max;r({target:"Array",proto:!0,forced:!v||!p},{slice:function(e,t){var a,r,d,u=c(this),f=o(u.length),v=s(e,f),p=s(void 0===t?f:t,f);if(i(u)&&(a=u.constructor,"function"!=typeof a||a!==Array&&!i(a.prototype)?n(a)&&(a=a[m],null===a&&(a=void 0)):a=void 0,a===Array||void 0===a))return h.call(u,v,p);for(r=new(void 0===a?Array:a)(b(p-v,0)),d=0;v<p;v++,d++)v in u&&l(r,d,u[v]);return r.length=d,r}})}}]);
//# sourceMappingURL=chunk-dabc0fd0.64bd33b8.js.map